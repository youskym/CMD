@echo off
whoami /priv | find "SeDebugPrivilege" > nul
if %errorlevel% neq 0 (
　echo 管理者権限がありません。管理者権限で実行します
　@powershell start-process \"%~0\" -verb runas
　exit
)
REM ここから下、exitまでを管理者として実行

echo ATOK風（かなキー無し）のキーバインドを追加します。
pause
echo 本当にやって良い？
pause

reg add "HKCU\SOFTWARE\Microsoft\IME\15.0\IMEJP\StyleList\Custom" /ve /f
reg add "HKCU\SOFTWARE\Microsoft\IME\15.0\IMEJP\StyleList\Custom" /v "defRoma" /t REG_SZ /d "MS-IME" /f
reg add "HKCU\SOFTWARE\Microsoft\IME\15.0\IMEJP\StyleList\Custom" /v "DisableFunctions" /t REG_DWORD /d "3" /f
reg add "HKCU\SOFTWARE\Microsoft\IME\15.0\IMEJP\StyleList\Custom" /v "key" /t REG_BINARY /d 53504143453d3831203436203330203330203037203036004374726c2b53504143453d38302034362033302038412030372030360053686966742b53504143453d3838203436203330203330203037203036004374726c2b53686966742b53504143453d3830203832203832203832203832203832004261636b53706163653d3830203135203045203045203045203135004374726c2b4261636b53706163653d38342030302030302030302030302030300053686966742b4261636b53706163653d383020313520314620314620304620304500456e7465723d3830203439203039203242203039203039004374726c2b456e7465723d38302034392030392030392030392030390053686966742b456e7465723d3830204431203039203039203039203039004573633d38302034442030442030442030442030440053686966742b4573633d38302034442030442030442030442030440094bc8a702f91538a703d434420303020303020303020303020303000897090943d38302032462032462032462032462032460096b395cf8ab73d4346203234203234203234203234203234004374726c2b96b395cf8ab73d38302032352032352032352032352032350053686966742b96b395cf8ab73d38302032362032362032362032362032360095cf8ab73d4345203436203330203330203037203036004374726c2b95cf8ab73d38302030302030302046372030302030300053686966742b95cf8ab73d383720343620314520314520303020303000834a835e834a83693d38302032352032352032352032352032350053686966742b834a835e834a83693d38302032452032452032452032452032450082d082e782aa82c83d3830203234203234203234203234203234005441423d383020443220383020384120383020383000496d654f6e3d434120434120434120434120434120434100416c742b496d654f6e3d3934203934203934203934203934203934004374726c2b496d654f6e3d38372030302030302030302030302030300053686966742b496d654f6e3d433920433920433920433920433920433900496d654f66663d4346204346204346204346204346204346004374726c2b496d654f66663d38302032382032382032382032382032380053686966742b496d654f66663d3830203236203236203236203236203236005061676555703d38302030302031452031452030302030300050616765446f776e3d383020303020314420314420303020303000456e643d383020313420303020333920464520313400486f6d653d38302031332030302033382046452031330081a93d3830203531203230203230203230203131004374726c2b81a93d38302035332031392031392032302031330053686966742b81a93d38302031312031372031372032302031310081aa3d3830203430203143203143203030203030004374726c2b81aa3d38302034302031432031432030302030300053686966742b81aa3d38302034302031432031432030302030300081a83d3830203532203231203231203231203132004374726c2b81a83d38302031342031412031412032312031340053686966742b81a83d38302031322031382031382032312031320081ab3d38302034392030412030412030412030410053686966742b81ab3d383020344320304120304120304120304100494e533d3830203430203045203045203045203045004374726c2b494e533d38302034302030452030452030452030450053686966742b494e533d38302034302030452030452030452030450044656c6574653d3830203136203030203030203030203136004374726c2b44656c6574653d38302031362030302042372030302031360053686966742b44656c6574653d3830203136203030203030203030203136004374726c2b413d3830203533203139203139203230203133004374726c2b443d3830203132203138203138203231203132004374726c2b453d3830203430203143203143203030203030004374726c2b463d3830203134203141203141203231203134004374726c2b473d3830203136203030203030203030203136004374726c2b483d3830203135203045203045203045203135004374726c2b493d3830203635203235203235203235203235004374726c2b4b3d3830203531203230203230203230203131004374726c2b4c3d3830203532203231203231203231203132004374726c2b4d3d3830203439203039203242203039203039004374726c2b4e3d3830203439203041203041203041203041004374726c2b4f3d3830203637203237203237203237203237004374726c2b503d3830203636203236203236203236203236004374726c2b533d3830203131203137203137203230203131004374726c2b553d38302036342032342032342032342032340046363d38302036342032342032342032342032340053686966742b46363d38302036322032322032322032322032320046373d3830203635203235203235203235203235004374726c2b46373d46312034302030302030302030302030300046383d38302036372032372032372032372032370046393d3830203636203236203236203236203236004631303d4430203646203246203246203246203246004374726c2b4631303d4635204635204635204635204635204635004374726c2b4631323d463020463020463020463020463020463000838d815b837d8e9a3d39342039342039342039342039342039340000 /f
reg add "HKCU\SOFTWARE\Microsoft\IME\15.0\IMEJP\StyleList\Custom" /v "S1key" /t REG_BINARY /d 53504143453d46462038312046462046462046462038310000 /f
reg add "HKCU\SOFTWARE\Microsoft\IME\15.0\IMEJP\StyleList\Custom" /v "S3key" /t REG_BINARY /d 4374726c2b4261636b53706163653d38302046462046462046462046462046460000 /f
reg add "HKCU\SOFTWARE\Microsoft\IME\15.0\IMEJP\StyleList\Custom" /v "S4key" /t REG_BINARY /d 94bc8a702f91538a703d43442030302030302030302030302030300095cf8ab73d43452030302030302030302030302030300053686966742b95cf8ab73d3837203030203030203030203030203030004374726c2b496d654f6e3d383720303020303020303020303020303000834a835e834a83693d43452030302030302030302030302030300053686966742b834a835e834a83693d43452030302030302030302030302030300082d082e782aa82c83d43452030302030302030302030302030300000 /f
reg add "HKCU\SOFTWARE\Microsoft\IME\15.0\IMEJP\StyleList\Custom" /v "S6key" /t REG_BINARY /d 4573633d38302030302030302030302030302030300081a93d38302031452030302030302030302030300081a83d383020314420303020303020303020303000456e7465723d3830204143204646204646204646204646004374726c2b456e7465723d38302041432046462046462046462046460053686966742b81a93d38302031452030302030302030302030300053686966742b81a83d3830203144203030203030203030203030004374726c2b443d3830203144203030203030203030203030004374726c2b4d3d3830204143204646204646204646204646004374726c2b533d3830203145203030203030203030203030004631303d44302044302044302044302044302044300046303d38302030302030302030302030302030300046313d38302030302030302030302030302030300046323d38302030302030302030302030302030300046333d38302030302030302030302030302030300046343d38302030302030302030302030302030300046353d38302030302030302030302030302030300046363d38302030302030302030302030302030300046373d38302030302030302030302030302030300046383d38302030302030302030302030302030300000 /f
reg add "HKCU\SOFTWARE\Microsoft\IME\15.0\IMEJP\StyleList\Custom" /v "S7key" /t REG_BINARY /d 81ab3d383020314220464620464620464620314200456e7465723d38302031342046462046462046462031340053504143453d3830203142204646204646204646203142004374726c2b53504143453d46462038412046462046462046462046460095cf8ab73d38302031422046462046462046462031420053686966742b95cf8ab73d3830203145204646204646204646203145005441423d4646203841204646204646204646204646005061676555703d38302031452046462046462046462031450050616765446f776e3d383020314420464620464620464620314400456e643d383020333920464620464620464620333900486f6d653d38302033382046462046462046462033380081aa3d3830203143204646204646204646203143004374726c2b81aa3d38302031432046462046462046462031430053686966742b81aa3d3830203143204646204646204646203143004374726c2b453d38302031432046462046462046462031430000 /f
reg add "HKCU\SOFTWARE\Microsoft\IME\15.0\IMEJP\StyleList\Custom" /v "S9key" /t REG_BINARY /d 81aa3d46462031432046462031432046462046460081ab3d46462031422046462031422046462046460081a93d46462038452046462038452046462046460081a83d46462038442046462038442046462046460000 /f
reg add "HKCU\SOFTWARE\Microsoft\IME\15.0\IMEJP\StyleList\Custom" /v "SDkey" /t REG_BINARY /d 5441423d38302044322044322044322038302038300081aa3d3830203430203143203143203030203030004374726c2b81aa3d38302034302031432031432030302030300053686966742b81aa3d3830203430203143203143203030203030004374726c2b453d38302034302031432031432030302030300095cf8ab73d46462046462044322044322046462046460053504143453d46462046462044322044322046462046460053686966742b53504143453d4646204646204432203143204646204646004374726c2b4e3d4646204646204646204645204646204646004374726c2b423d46462046412046462046412046462046460000 /f
reg add "HKCU\SOFTWARE\Microsoft\IME\15.0\IMEJP\MSIME" /v "keystyle" /t REG_SZ /d "Custom" /f
echo Y | reg delete "HKCU\SOFTWARE\Microsoft\IME\15.0\IMEJP\StyleList\Custom" /ve
pause
